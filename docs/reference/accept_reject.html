<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function implements the acceptance-rejection method for generating random numbers from a given probability density function (pdf)."><title>Acceptance-Rejection Method — accept_reject • AcceptReject</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Acceptance-Rejection Method — accept_reject"><meta property="og:description" content="This function implements the acceptance-rejection method for generating random numbers from a given probability density function (pdf)."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">AcceptReject</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/accept_reject.html">Acceptance and rejection method</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/prdm0/AcceptReject/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Acceptance-Rejection Method</h1>
      <small class="dont-index">Source: <a href="https://github.com/prdm0/AcceptReject/blob/HEAD/R/accept_reject.r" class="external-link"><code>R/accept_reject.r</code></a></small>
      <div class="d-none name"><code>accept_reject.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements the acceptance-rejection method for generating random numbers from a given probability density function (pdf).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">accept_reject</span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  f <span class="op">=</span> <span class="va">dweibull</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  c <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  linesearch_algorithm <span class="op">=</span> <span class="st">"LBFGS_LINESEARCH_BACKTRACKING_ARMIJO"</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  start_c <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>n</dt>
<dd><p>The number of random numbers to generate.</p></dd>


<dt>continuous</dt>
<dd><p>A logical value indicating whether the pdf is continuous or discrete. Default is <code>TRUE</code>.</p></dd>


<dt>f</dt>
<dd><p>The probability density function (<code>continuous = TRUE</code>), in the continuous case or the probability mass function, in the discrete case (<code>continuous = FALSE</code>).</p></dd>


<dt>args_f</dt>
<dd><p>A list of arguments to be passed to the pdf function.</p></dd>


<dt>xlim</dt>
<dd><p>A vector specifying the range of values for the random numbers in the form <code>c(min, max)</code>. Default is <code>c(0, 100)</code>.</p></dd>


<dt>c</dt>
<dd><p>A constant value used in the acceptance-rejection method. If <code>NULL</code>, it will be estimated using the <code><a href="https://rdrr.io/pkg/lbfgs/man/lbfgs.html" class="external-link">lbfgs::lbfgs()</a></code> optimization algorithm. Default is <code>NULL</code>.</p></dd>


<dt>linesearch_algorithm</dt>
<dd><p>The linesearch algorithm to be used in the <code><a href="https://rdrr.io/pkg/lbfgs/man/lbfgs.html" class="external-link">lbfgs::lbfgs()</a></code> optimization. Default is <code>"LBFGS_LINESEARCH_BACKTRACKING_ARMIJO"</code>.</p></dd>


<dt>max_iterations</dt>
<dd><p>The maximum number of iterations for the <code><a href="https://rdrr.io/pkg/lbfgs/man/lbfgs.html" class="external-link">lbfgs::lbfgs()</a></code> optimization. Default is <code>1000</code>.</p></dd>


<dt>epsilon</dt>
<dd><p>The convergence criterion for the <code><a href="https://rdrr.io/pkg/lbfgs/man/lbfgs.html" class="external-link">lbfgs::lbfgs()</a></code> optimization. Default is <code>1e-6</code>.</p></dd>


<dt>start_c</dt>
<dd><p>The initial value for the constant <code>c</code> in the <code><a href="https://rdrr.io/pkg/lbfgs/man/lbfgs.html" class="external-link">lbfgs::lbfgs()</a></code> optimization. Default is <code>25</code>.</p></dd>


<dt>parallel</dt>
<dd><p>A logical value indicating whether to use parallel processing for generating random numbers. Default is <code>FALSE</code>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments to be passed to the <code><a href="https://rdrr.io/pkg/lbfgs/man/lbfgs.html" class="external-link">lbfgs::lbfgs()</a></code> optimization algorithm. For details, see <code><a href="https://rdrr.io/pkg/lbfgs/man/lbfgs.html" class="external-link">lbfgs::lbfgs()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A vector of random numbers generated using the acceptance-rejection method.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In situations where we cannot use the inversion method (situations where it is not possible to obtain the quantile function) and we do not know a transformation that involves a random variable from which we can generate observations, we can use the acceptance and rejection method.
Suppose that \(X\) and \(Y\) are random variables with probability density function (pdf) or probability function (pf) \(f\) and \(g\), respectively. In addition, suppose that there is a constant \(c\) such that</p>
<p>$$f(x) \leq c \cdot g(x), \quad \forall x \in \mathbb{R}.$$</p>
<p>for all values of \(t\), with \(f(t)&gt;0\). To use the acceptance and rejection method to generate observations from the random variable \(X\), using the algorithm below, first find a random variable \(Y\) with pdf or pf \(g\), that satisfies the above condition.</p>
<p>Algorithm of the Acceptance and Rejection Method:</p>
<p>1 - Generate an observation \(y\) from a random variable \(Y\) with pdf/pf \(g\);</p>
<p>2 - Generate an observation \(u\) from a random variable \(U\sim \mathcal{U} (0, 1)\);</p>
<p>3 - If \(u &lt; \frac{f(y)}{cg(y)}\) accept \(x = y\); otherwise reject \(y\) as an observation of the random variable \(X\) and return to step 1.</p>
<p>Proof: Let's consider the discrete case, that is, \(X\) and \(Y\) are random variables with pf's \(f\) and \(g\), respectively. By step 3 of the above algorithm, we have that \({accept} = {x = y} = u &lt; \frac{f(y)}{cg(y)}\). That is,</p>
<p>\(P(accept | Y = y) = \frac{P(accept \cap {Y = y})}{g(y)} = \frac{P(U \leq f(y)/cg(y)) \times g(y)}{g(y)} = \frac{f(y)}{cg(y)}.\)</p>
<p>Hence, by the Total Probability Theorem, we have that:</p>
<p>\(P(accept) = \sum_y P(accept|Y=y)\times P(Y=y) = \sum_y \frac{f(y)}{cg(y)}\times g(y) = \frac{1}{c}.\)</p>
<p>Therefore, by the acceptance and rejection method we accept the occurrence of $Y$ as being an occurrence of \(X\) with probability \(1/c\). In addition, by Bayes' Theorem, we have that</p>
<p>\(P(Y = y | accept) = \frac{P(accept|Y = y)\times g(y)}{P(accept)} = \frac{[f(y)/cg(y)] \times g(y)}{1/c} = f(y).\)</p>
<p>The result above shows that accepting \(x = y\) by the procedure of the algorithm is equivalent to accepting a value from \(X\) that has pf \(f\).</p>
<p>The argument <code>c = NULL</code> is the default. Thus, the function <code>accept_reject()</code> estimates the value of c using the optimization algorithm <code><a href="https://rdrr.io/pkg/lbfgs/man/lbfgs.html" class="external-link">lbfgs::lbfgs()</a></code>. For more details, see <code><a href="https://rdrr.io/pkg/lbfgs/man/lbfgs.html" class="external-link">lbfgs::lbfgs()</a></code>.
If a value of <code>c</code> is provided, the function <code>accept_reject()</code> will use this value to generate the random observations. An inappropriate choice of c can lead to low efficiency of the acceptance and rejection method.</p>
<p>In Unix-based operating systems, the function <code>accept_reject()</code> can be executed in parallel. To do this, simply set the argument <code>parallel = TRUE</code>.
The function <code>accept_reject()</code> utilizes the <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">parallel::mclapply()</a></code> function to execute the acceptance and rejection method in parallel.
On Windows operating systems, the code will be seral even if <code>parallel = TRUE</code> is set.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>CASELLA, George; ROBERT, Christian P.; WELLS, Martin T. Generalized accept-reject sampling schemes. Lecture Notes-Monograph Series, p. 342-347, 2004.</p>
<p>NEAL, Radford M. Slice sampling. The annals of statistics, v. 31, n. 3, p. 705-767, 2003.</p>
<p>BISHOP, Christopher. 11.4: Slice sampling. Pattern Recognition and Machine Learning. Springer, 2006.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">parallel::mclapply()</a></code> and <code><a href="https://rdrr.io/pkg/lbfgs/man/lbfgs.html" class="external-link">lbfgs::lbfgs()</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="co"># setting a seed for reproducibility</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">accept_reject</span><span class="op">(</span></span></span>
<span class="r-in"><span> n <span class="op">=</span> <span class="fl">2000L</span>,</span></span>
<span class="r-in"><span> f <span class="op">=</span> <span class="va">dbinom</span>,</span></span>
<span class="r-in"><span> continuous <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span> args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="accept_reject-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">accept_reject</span><span class="op">(</span></span></span>
<span class="r-in"><span> n <span class="op">=</span> <span class="fl">1000L</span>,</span></span>
<span class="r-in"><span> f <span class="op">=</span> <span class="va">dnorm</span>,</span></span>
<span class="r-in"><span> continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span> args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="accept_reject-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Pedro Rafael D. Marinho, Vera Lucia Damasceno Tomazella.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

