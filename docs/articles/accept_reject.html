<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="AcceptReject">
<title>Acceptance and rejection method • AcceptReject</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Acceptance and rejection method">
<meta property="og:description" content="AcceptReject">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">AcceptReject</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/accept_reject.html">Acceptance and rejection method</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/prdm0/AcceptReject/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Acceptance and rejection method</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/prdm0/AcceptReject/blob/HEAD/vignettes/accept_reject.Rmd" class="external-link"><code>vignettes/accept_reject.Rmd</code></a></small>
      <div class="d-none name"><code>accept_reject.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="understanding-the-method">Understanding the Method<a class="anchor" aria-label="anchor" href="#understanding-the-method"></a>
</h2>
<p>In situations where we cannot use the inversion method (situations
where obtaining the quantile function is not possible) and neither do we
know a transformation involving a random variable from which we can
generate observations, we can make use of the
<strong>acceptance-rejection method</strong>.</p>
<p>Suppose <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are random variables with probability
density function (pdf) or probability function (pf) <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span>, respectively. Furthermore, suppose
there exists a constant <span class="math inline">\(c\)</span> such
that</p>
<p><span class="math display">\[\frac{f(x)}{g(y)} \leq c,\]</span> for
every value of <span class="math inline">\(x\)</span>, with <span class="math inline">\(f(x) &gt; 0\)</span>. To use the
acceptance-rejection method to generate observations of the random
variable <span class="math inline">\(X\)</span>, using the algorithm
below, first find a random variable <span class="math inline">\(Y\)</span> with pdf or pf <span class="math inline">\(g\)</span>, such that it satisfies the above
condition.</p>
<p><strong>Important</strong>:</p>

<div class="rmdimportant">
<div class="text-justify">
<p>It is important that the chosen random variable <span class="math inline">\(Y\)</span> is such that you can easily generate
its observations. This is because the acceptance-rejection method is
computationally more intensive than more direct methods such as the
transformation method or the inversion method, which only requires the
generation of pseudo-random numbers with a uniform distribution.</p>
</div>
</div>
<p><strong>Algorithm of the Acceptance-Rejection Method</strong>:</p>
<p>1 - Generate an observation <span class="math inline">\(y\)</span>
from a random variable <span class="math inline">\(Y\)</span> with
pdf/pf <span class="math inline">\(g\)</span>;</p>
<p>2 - Generate an observation <span class="math inline">\(u\)</span>
from a random variable <span class="math inline">\(U\sim \mathcal{U} (0,
1)\)</span>;</p>
<p>3 - If <span class="math inline">\(u &lt; \frac{f(y)}{cg(y)}\)</span>
accept <span class="math inline">\(x = y\)</span>; otherwise reject
<span class="math inline">\(y\)</span> as an observation of the random
variable <span class="math inline">\(X\)</span> and go back to step
1.</p>
<p><strong>Proof</strong>: Consider the discrete case, that is, <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are random variables with pfs <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span>, respectively. By step 3 of the
algorithm above, we have <span class="math inline">\(\{accept\} = \{x =
y\} = u &lt; \frac{f(y)}{cg(y)}\)</span>. That is,</p>
<p><span class="math display">\[P(accept | Y = y) = \frac{P(accept \cap
\{Y = y\})}{g(y)} = \frac{P(U \leq f(y)/cg(y)) \times g(y)}{g(y)} =
\frac{f(y)}{cg(y)}.\]</span> Hence, by the <a href="https://en.wikipedia.org/wiki/Law_of_total_probability" class="external-link"><strong>Law
of Total Probability</strong></a>, we have:</p>
<p><span class="math display">\[P(accept) = \sum_y P(accept|Y=y)\times
P(Y=y) = \sum_y \frac{f(y)}{cg(y)}\times g(y) = \frac{1}{c}.\]</span>
Therefore, by the acceptance-rejection method, we accept the occurrence
of <span class="math inline">\(Y\)</span> as an occurrence of <span class="math inline">\(X\)</span> with probability <span class="math inline">\(1/c\)</span>. Moreover, by Bayes’ Theorem, we
have</p>
<p><span class="math display">\[P(Y = y | accept) = \frac{P(accept|Y =
y)\times g(y)}{P(accept)} = \frac{[f(y)/cg(y)] \times g(y)}{1/c} =
f(y).\]</span> The result above shows that accepting <span class="math inline">\(x = y\)</span> by the algorithm’s procedure is
equivalent to accepting a value from <span class="math inline">\(X\)</span> that has pf <span class="math inline">\(f\)</span>. For the continuous case, the proof is
similar.</p>
<p><strong>Important</strong>:</p>

<div class="rmdimportant">
<div class="text-justify">
<p>Notice that to reduce the computational cost of the method, we should
choose <span class="math inline">\(c\)</span> in such a way that we can
maximize <span class="math inline">\(P(accept)\)</span>. Therefore,
choosing an excessively large value of the constant <span class="math inline">\(c\)</span> will reduce the probability of
accepting an observation from <span class="math inline">\(Y\)</span> as
an observation of the random variable <span class="math inline">\(X\)</span>.</p>
</div>
</div>
<p><strong>Note</strong>:</p>

<div class="rmdnote">
<div class="text-justify">
<p>Computationally, it is convenient to consider <span class="math inline">\(Y\)</span> as a random variable with a uniform
distribution on the support of <span class="math inline">\(f\)</span>,
since generating observations from a uniform distribution is
straightforward on any computer. For the discrete case, considering
<span class="math inline">\(Y\)</span> with a discrete uniform
distribution might be a good alternative.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="installation-and-loading-the-package">Installation and loading the package<a class="anchor" aria-label="anchor" href="#installation-and-loading-the-package"></a>
</h2>
<p>The <code>AcceptReject</code> package is available on CRAN and can be
installed using the following command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="co"># or remotes::install_github("prdm0/AcceptReject", force = TRUE)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="using-the-accept_reject-function">Using the <code>accept_reject</code> Function<a class="anchor" aria-label="anchor" href="#using-the-accept_reject-function"></a>
</h3>
<p>Among various functions provided by the AcceptReject library, the
acceptance_rejection function implements the acceptance-rejection
method. The <code><a href="../reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function has the
following signature:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  f <span class="op">=</span> <span class="va">dweibull</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  c <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  linesearch_algorithm <span class="op">=</span> <span class="st">"LBFGS_LINESEARCH_BACKTRACKING_ARMIJO"</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  start_c <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Many of the arguments the user will not need to change, as the
<code><a href="../reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function already has default
values for them. However, it is important to note that the f argument is
the probability density function (pdf) or probability function (pf) of
the random variable <span class="math inline">\(X\)</span> from which
observations are desired to be generated. The <code>args_f</code>
argument is a list of arguments that will be passed to the f function.
The <code>c</code> argument is the value of the constant <code>c</code>
that will be used in the acceptance-rejection method. If the user does
not provide a value for <code>c</code>, the
<code><a href="../reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function will calculate the
value of <code>c</code> that maximizes the probability of accepting
observations from <span class="math inline">\(Y\)</span> as observations
from <span class="math inline">\(X\)</span>.</p>
<p><strong>Note</strong>:</p>

<div class="rmdnote">
An important observation is that the
<code><a href="https://rdrr.io/pkg/zmpg/man/acceptance_rejection.html" class="external-link">zmpg::acceptance_rejection()</a></code> function can work in a
parallelized manner on Unix-based operating systems. If you use
operating systems such as Linux or MacOS, you can benefit from
parallelization of the <code><a href="https://rdrr.io/pkg/zmpg/man/acceptance_rejection.html" class="external-link">zmpg::acceptance_rejection()</a></code>
function. To do this, simply set the <code>parallel = TRUE</code>
argument. In Windows, parallelization is not supported, and setting the
<code>parallel = TRUE</code> argument will have no effect.
</div>
<p>You do not need to define the <code>c</code> argument when using the
<code><a href="../reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function. By default, if
<code>c = NULL</code>, the <code><a href="../reference/accept_reject.html">AcceptReject::accept_reject()</a></code>
function will calculate the value of <code>c</code> that maximizes the
probability of accepting observations from <span class="math inline">\(Y\)</span> as observations from <span class="math inline">\(X\)</span>. However, if you want to set a value
for <code>c</code>, simply pass a value to the <code>c</code>
argument.</p>
<p><strong>Details of the optimization of <code>c</code></strong>:</p>

<div class="rmdnote">
Depending on how complicated the probability density function (pdf) or
probability function (pf) of the random variable <span class="math inline">\(X\)</span> from which observations are desired to
be generated is, optimizing the value of <code>c</code> can be a
difficult optimization process, but generally, it is not. Therefore,
unless you have reasons to set a value for <code>c</code>, it is
recommended to use the default value <code>c = NULL</code>. For very
complicated functions, you may choose a sufficiently large
<code>c</code> to ensure that the method works well.
</div>
<p>The arguments <code>linesearch_algorithm</code>,
<code>max_iterations</code>, <code>epsilon</code>, <code>start_c</code>,
and <code>...</code> are arguments that control the optimization
algorithm of the <code>c</code> value. The
<code>linesearch_algorithm</code> argument is the line search algorithm
that will be used in the optimization of the <code>c</code> value. The
<code>max_iterations</code> argument is the maximum number of iterations
that the optimization algorithm will perform. The <code>epsilon</code>
argument is the stopping criterion of the optimization algorithm. The
<code>start_c</code> argument is the initial value of <code>c</code>
that will be used in the optimization algorithm. These are arguments
passed to the <code><a href="https://rdrr.io/pkg/lbfgs/man/lbfgs.html" class="external-link">lbfgs::lbfgs()</a></code> function, and generally, you
will not need to change them.</p>
</div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>Below are some examples of using the
<code><a href="../reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function to generate
pseudo-random observations of discrete and continuous random variables.
It should be noted that in the case of <span class="math inline">\(X\)</span> being a discrete random variable, it is
necessary to provide the argument <code>continuous = FALSE</code>,
whereas in the case of <span class="math inline">\(X\)</span> being
continuous (the default), you must consider
<code>continuous = TRUE</code>.</p>
<div class="section level3">
<h3 id="generating-discrete-observations">Generating discrete observations<a class="anchor" aria-label="anchor" href="#generating-discrete-observations"></a>
</h3>
<p>As an example, let <span class="math inline">\(X \sim Poisson(\lambda
= 0.7)\)</span>. We will generate <span class="math inline">\(n =
1000\)</span> observations of <span class="math inline">\(X\)</span>
using the acceptance-rejection method, using the
<code><a href="../reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function. Note that it is
necessary to provide the <code>xlim</code> argument. Try to set an upper
limit value for which the probability of <span class="math inline">\(X\)</span> assuming that value is zero or very
close to zero. In this case, we choose <code>xlim = c(0, 20)</code>,
where <code>dpois(x = 20, lambda = 0.7)</code> is very close to zero
(1.6286586^{-22}).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensuring Reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Generating observations</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">AcceptReject</span><span class="fu">::</span><span class="fu"><a href="../reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  f <span class="op">=</span> <span class="va">dpois</span>,</span>
<span>  continuous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Viewing organized output with useful information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Accept-Reject Samples</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> It's not necessary, but if you want to extract the observations, use as.vector().</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Number of observations: 1000</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> c: 10.4282913773332</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Probability of acceptance (1/c): 0.0958929860910474</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Observations: 0 0 0 0 1 0 0 2 1 2...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">────────────────────────────────────────────────────────────────────────────────</span></span></span>
<span></span>
<span><span class="co"># Calculating the true probability function for each observed value</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">true_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois</a></span><span class="op">(</span><span class="va">values</span>, lambda <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculating the observed probability for each value in the observations vector</span></span>
<span><span class="va">obs_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting the probabilities and observations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">true_prob</span>, type <span class="op">=</span> <span class="st">"p"</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"Probability"</span>, main <span class="op">=</span> <span class="st">"Probability Function"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adding the observed probabilities</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obs_prob</span><span class="op">)</span><span class="op">)</span>, <span class="va">obs_prob</span>, pch <span class="op">=</span> <span class="fl">16L</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True probability"</span>, <span class="st">"Observed probability"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16L</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="accept_reject_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Note that it is necessary to specify the nature of the random
variable from which observations are desired to be generated. In the
case of discrete variables, the argument <code>continuous = FALSE</code>
must be passed.</p>
<p>Now, consider that we want to generate observations from a random
variable <span class="math inline">\(X \sim Binomial(n = 5, p =
0.7)\)</span>. Below, we will generate <span class="math inline">\(n =
2000\)</span> observations of <span class="math inline">\(X\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensuring reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Generating observations</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">AcceptReject</span><span class="fu">::</span><span class="fu"><a href="../reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2000L</span>,</span>
<span>  f <span class="op">=</span> <span class="va">dbinom</span>,</span>
<span>  continuous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Viewing organized output with useful information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Accept-Reject Samples</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> It's not necessary, but if you want to extract the observations, use as.vector().</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Number of observations: 2000</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> c: 6.56249999733451</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Probability of acceptance (1/c): 0.152380952442845</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Observations: 3 4 4 2 3 1 2 4 2 2...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">────────────────────────────────────────────────────────────────────────────────</span></span></span>
<span></span>
<span><span class="co"># Calculating the true probability function for each observed value</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">true_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">dbinom</a></span><span class="op">(</span><span class="va">values</span>, size <span class="op">=</span> <span class="fl">5</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculating the observed probability for each value in the observations vector</span></span>
<span><span class="va">obs_prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting the probabilities and observations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">values</span>, <span class="va">true_prob</span>, type <span class="op">=</span> <span class="st">"p"</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"Probability"</span>, main <span class="op">=</span> <span class="st">"Probability Function"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adding the observed probabilities</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">obs_prob</span><span class="op">)</span><span class="op">)</span>, <span class="va">obs_prob</span>, pch <span class="op">=</span> <span class="fl">16L</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True probability"</span>, <span class="st">"Observed probability"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16L</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="accept_reject_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="generating-continuous-observations">Generating continuous observations<a class="anchor" aria-label="anchor" href="#generating-continuous-observations"></a>
</h3>
<p>To expand beyond examples of generating pseudo-random observations of
discrete random variables, consider now that we want to generate
observations from a random variable <span class="math inline">\(X \sim
\mathcal{N}(\mu = 0, \sigma^2 = 1)\)</span>. We chose the normal
distribution because we are familiar with its form, but you can choose
another distribution if desired. Below, we will generate
<code>n = 2000</code> observations using the acceptance-rejection
method. Note that <code>continuous = TRUE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensuring reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Generating observations</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">AcceptReject</span><span class="fu">::</span><span class="fu"><a href="../reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2000L</span>,</span>
<span>  f <span class="op">=</span> <span class="va">dnorm</span>,</span>
<span>  continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Viewing organized output with useful information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Accept-Reject Samples</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> It's not necessary, but if you want to extract the observations, use as.vector().</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Number of observations: 2000</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> c: 3.19153824335755</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Probability of acceptance (1/c): 0.313328534314533</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Observations: -1.023 -0.0184 -0.9111 0.7965 0.4243 2.3148 -0.1822 -2.0416 0.1491 2.1305...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">────────────────────────────────────────────────────────────────────────────────</span></span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Generating Gaussian observations"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>  probability <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, length.out <span class="op">=</span> <span class="fl">500L</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="st">"True density"</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="accept_reject_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
<p>In the examples above, the graphs were built without using the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">AcceptReject::plot()</a></code> function. This is just to show that
you can manipulate the returning object using the
<code><a href="../reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function, that is, the class
object <code>accept_reject</code>.</p>
<p>However, the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">AcceptReject::plot()</a></code> function can be used
to generate graphs in a simpler way. Below, an example of how to use the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">AcceptReject::plot()</a></code> function to generate the probability
density plot of the normal distribution. However, note that the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">AcceptReject::plot()</a></code> function makes the plotting task
simpler and more direct. See the following example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span> <span class="co"># install.packages("pacthwork")</span></span>
<span></span>
<span><span class="co"># Ensuring reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">AcceptReject</span><span class="fu">::</span><span class="fu"><a href="../reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="va">n</span>,</span>
<span>    f <span class="op">=</span> <span class="va">dnorm</span>,</span>
<span>    continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>    parallel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Inspecting</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">250L</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2500L</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25000L</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">250000L</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span></span></code></pre></div>
<p><img src="accept_reject_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
<p>See another example, in the discrete case:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span> <span class="co"># install.packages("patchwork")</span></span>
<span><span class="co"># Ensuring Reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">AcceptReject</span><span class="fu">::</span><span class="fu"><a href="../reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>    f <span class="op">=</span> <span class="va">dpois</span>,</span>
<span>    continuous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>    parallel <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span><span class="fl">25L</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span><span class="fl">250L</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span><span class="fl">2500L</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span><span class="fl">25000L</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span></span></code></pre></div>
<p><img src="accept_reject_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="accessing-metadata">Accessing metadata<a class="anchor" aria-label="anchor" href="#accessing-metadata"></a>
</h3>
<p>The <code><a href="../reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function returns an
object of class <code>accept_reject</code>. When executing the
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> function on an object of this class, an organized
output will be shown. However, you can operate on this instance of the
<code>accept_reject</code> class as any atomic vector. In the example
below, notice that you can obtain a histogram with the
<code><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist()</a></code> function or check the size of the vector of
observations generated using the <code><a href="https://rdrr.io/r/base/length.html" class="external-link">length()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>  f <span class="op">=</span> <span class="va">dnorm</span>,</span>
<span>  continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Creating a histogram</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<p><img src="accept_reject_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Checking the size of the vector of observations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 500</span></span></code></pre></div>
<p>If you want to access some metadata, use the <code><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr()</a></code>
function. Check the list of attributes by doing:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  f <span class="op">=</span> <span class="va">dnorm</span>,</span>
<span>  continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; $class</span></span>
<span><span class="co">#&gt; [1] "accept_reject"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $f</span></span>
<span><span class="co">#&gt; function (x, mean = 0, sd = 1, log = FALSE) </span></span>
<span><span class="co">#&gt; .Call(C_dnorm, x, mean, sd, log)</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x62bbe7a0b150&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: namespace:stats&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $args_f</span></span>
<span><span class="co">#&gt; $args_f$mean</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $args_f$sd</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $c</span></span>
<span><span class="co">#&gt; [1] 3.191538</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $continuous</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $xlim</span></span>
<span><span class="co">#&gt; [1] -4  4</span></span>
<span></span>
<span><span class="co"># Accessing the value c</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"c"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.191538</span></span></code></pre></div>
<p>In any case, it is important to highlight that, in general, you will
not need to access these attributes. The greatest interest will be in
having access to the vector of observations generated. If you want to
access the observation values directly in an atomic vector in R without
attributes, without an organized printout, simply coerce the object
using the <code><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector()</a></code> function, as shown in the following
example:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  f <span class="op">=</span> <span class="va">dnorm</span>,</span>
<span>  continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "accept_reject"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Accept-Reject Samples</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> It's not necessary, but if you want to extract the observations, use as.vector().</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Number of observations: 100</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> c: 3.19153824335755</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Probability of acceptance (1/c): 0.313328534314533</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Observations: -1.5387 0.3894 -1.1376 -1.1119 0.9404 1.0471 -0.617 0.1396 -0.6566 1.9164...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">────────────────────────────────────────────────────────────────────────────────</span></span></span>
<span></span>
<span><span class="co"># Coercing the object into an atomic vector without attributes</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   [1] -1.53870467  0.38939574 -1.13758586 -1.11193044  0.94041345  1.04709638</span></span>
<span><span class="co">#&gt;   [7] -0.61698095  0.13963057 -0.65663915  1.91636525 -0.12336472 -0.49628675</span></span>
<span><span class="co">#&gt;  [13]  0.31267925 -0.56685336  0.78333928 -1.65211592 -1.57053891  2.70437769</span></span>
<span><span class="co">#&gt;  [19] -0.88338146 -1.25963761 -1.76581944 -0.26738425 -0.51704984  0.19508744</span></span>
<span><span class="co">#&gt;  [25]  1.16429157 -0.65323033  0.42140778 -1.58613284  1.05725540  1.71607799</span></span>
<span><span class="co">#&gt;  [31]  1.56007421  1.24794785 -0.52846813  1.09929632 -0.03209583 -0.31734041</span></span>
<span><span class="co">#&gt;  [37] -0.26176246  0.05915411 -1.36006397  0.57914058 -1.14458484  0.13927373</span></span>
<span><span class="co">#&gt;  [43]  1.11677352  1.05017015 -1.92517745 -1.47765510  0.19147936  0.31150732</span></span>
<span><span class="co">#&gt;  [49] -0.32513807  0.50762851 -0.13175768  0.49965012 -0.79175195  0.12672810</span></span>
<span><span class="co">#&gt;  [55]  0.14944701  0.03548614 -0.29588091 -1.18112264  1.49476458  0.84075588</span></span>
<span><span class="co">#&gt;  [61]  0.49501813  0.98546915  1.06355776  0.90327224 -0.97355275 -0.54394192</span></span>
<span><span class="co">#&gt;  [67]  1.36181954 -1.54269020 -0.59670195 -0.56469662 -1.83341560 -0.57205664</span></span>
<span><span class="co">#&gt;  [73]  0.10227137  0.01935146 -0.55981698 -1.19642650  0.94177106  0.21643013</span></span>
<span><span class="co">#&gt;  [79] -0.59901242  0.65251458  0.21879227  1.25072688  1.27202878 -1.30618769</span></span>
<span><span class="co">#&gt;  [85] -0.76321989  1.12885593  1.01499283 -0.81376197  0.59667628 -0.34872457</span></span>
<span><span class="co">#&gt;  [91]  0.85112555  1.33809701 -0.51935011  0.92024392  0.20225682 -1.29229795</span></span>
<span><span class="co">#&gt;  [97]  0.28451799  0.51134847  0.37151868 -0.05340494</span></span></code></pre></div>
<p><strong>Important</strong>:</p>

<div class="rmdnote">
<p>You will not need to coerce the object of the
<code>accept_reject</code> class into an atomic vector with no
attributes unless you have a specific reason to do so. The object of the
<code>accept_reject</code> class is an atomic vector with attributes,
and you can operate on it like any atomic vector. Everything you can do
with an atomic vector, you can do with an object of the
<code>accept_reject</code> class.</p>
<strong>Using unnecessary coercion may impose a certain computational
cost, depending on the size of the vector of observations generated, for
example, in a simulation study.</strong>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Pedro Rafael D. Marinho, Vera Lucia Damasceno Tomazella.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
