<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="AcceptReject">
<title>It works for any univariate distribution • AcceptReject</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="It works for any univariate distribution">
<meta property="og:description" content="AcceptReject">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">AcceptReject</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/accept_reject.html">Acceptance and rejection method</a>
    <a class="dropdown-item" href="../articles/inspect.html">Specifying a base probability density function</a>
    <a class="dropdown-item" href="../articles/it_works_for_any_univariate_distribution.html">It works for any univariate distribution</a>
    <a class="dropdown-item" href="../articles/qqplot.html">QQ-Plot</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/prdm0/AcceptReject/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>It works for any univariate distribution</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/prdm0/AcceptReject/blob/HEAD/vignettes/it_works_for_any_univariate_distribution.Rmd" class="external-link"><code>vignettes/it_works_for_any_univariate_distribution.Rmd</code></a></small>
      <div class="d-none name"><code>it_works_for_any_univariate_distribution.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="it-works-for-any-univariate-distribution">It works for any univariate distribution<a class="anchor" aria-label="anchor" href="#it-works-for-any-univariate-distribution"></a>
</h2>
<p>Although most examples presented on this site and in the function
documentation involve densities implemented in R, the
<code><a href="../reference/accept_reject.html">accept_reject()</a></code> function is capable of generating samples
from any univariate distribution, whether it is in R or not, or even one
that has not yet been invented. In other words, as long as you have a
density, just write the density and pass it to the
<code><a href="../reference/accept_reject.html">accept_reject()</a></code> function.</p>
<p>The <a href="https://CRAN.R-project.org/package=AcceptReject" class="external-link"><strong>AcceptReject</strong></a>
package is designed to be generic and timeless. Consider, for example,
the family of Modified beta distributions, proposed in the paper <a href="https://link.springer.com/article/10.1007/s13571-013-0077-0" class="external-link">Modified
beta distributions</a>. This is a family of probability distributions,
as it is possible to generate various probability density functions
through the proposed density generator, whose general density function
is defined by:</p>
<p><span class="math display">\[f_X(x) = \frac{\beta^a}{B(a,b)} \times
\frac{g(x)G(x)^{a - 1}(1 - G(x))^{b - 1}}{[1 - (1 - \beta)G(x)]^{a +
b}},\]</span> with <span class="math inline">\(x \geq 0\)</span> and
<span class="math inline">\(\beta, a, b &gt; 0\)</span>, where <span class="math inline">\(g(x)\)</span> is a probability density function,
<span class="math inline">\(G(x)\)</span> is the cumulative distribution
function of <span class="math inline">\(g(x)\)</span>, and <span class="math inline">\(B(a,b)\)</span> is the beta function.</p>
<p>The authors present a quantile function in closed form that depends
on the quantile of the base distribution, that is, <span class="math inline">\(G^{-1}(u) = x\)</span> is known. But here, this is
not the case. We will use the <code><a href="../reference/accept_reject.html">accept_reject()</a></code> function to
generate samples from the Modified Beta - <span class="math inline">\(G\)</span> distribution, which is a distribution
that is not natively in R and could eventually be implemented by the
package user.</p>
<div class="float">
<img src="ok.gif" alt="Got the idea?"><div class="figcaption">Got the idea?</div>
</div>
<p>The following code implements the density (derived in <span class="math inline">\(x\)</span> from the Modified Beta - <span class="math inline">\(G\)</span>), for any <span class="math inline">\(G\)</span>. It is important to note that the user
could implement it in another way. What matters is that the user has a
function that implements the probability density function.</p>
<p>The user could, if desired, implement it directly for a specific
<span class="math inline">\(G\)</span>, for example, Weibull. Here, it
will be implemented for any <span class="math inline">\(G\)</span>.</p>
<p>Always remember, the <code><a href="../reference/accept_reject.html">accept_reject()</a></code> function only needs
the argument <code>f</code> to be a function that implements the
probability density function in the continuous case or a probability
mass function in the discrete case.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://optimizer.r-forge.r-project.org/" class="external-link">numDeriv</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pdf</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">G</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">numDeriv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/numDeriv/man/grad.html" class="external-link">grad</a></span><span class="op">(</span></span>
<span>    func <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">G</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="va">x</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Modified Beta Distributions</span></span>
<span><span class="co"># Link: https://link.springer.com/article/10.1007/s13571-013-0077-0</span></span>
<span><span class="va">generator</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">G</span>, <span class="va">a</span>, <span class="va">b</span>, <span class="va">beta</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/pdf.html" class="external-link">pdf</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, G <span class="op">=</span> <span class="va">G</span>, <span class="va">...</span><span class="op">)</span></span>
<span>  <span class="va">numerator</span> <span class="op">&lt;-</span> <span class="va">beta</span><span class="op">^</span><span class="va">a</span> <span class="op">*</span> <span class="va">g</span> <span class="op">*</span> <span class="fu">G</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">a</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu">G</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">b</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">denominator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">beta</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">beta</span><span class="op">)</span> <span class="op">*</span> <span class="fu">G</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span><span class="op">)</span></span>
<span>  <span class="va">numerator</span><span class="op">/</span><span class="va">denominator</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Probability density function - Modified Beta Weibull</span></span>
<span><span class="va">pdf_mbw</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">a</span>, <span class="va">b</span>, <span class="va">beta</span>, <span class="va">shape</span>, <span class="va">scale</span><span class="op">)</span></span>
<span>  <span class="fu">generator</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">x</span>,</span>
<span>    G <span class="op">=</span> <span class="va">pweibull</span>,</span>
<span>    a <span class="op">=</span> <span class="va">a</span>,</span>
<span>    b <span class="op">=</span> <span class="va">b</span>,</span>
<span>    beta <span class="op">=</span> <span class="va">beta</span>,</span>
<span>    shape <span class="op">=</span> <span class="va">shape</span>,</span>
<span>    scale <span class="op">=</span> <span class="va">scale</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Checking the value of the integral</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span></span>
<span>  f <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">pdf_mbw</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  lower <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">Inf</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; 1 with absolute error &lt; 5.7e-05</span></span></code></pre></div>
<p>Notice that the <code>pdf_mbw()</code> integrates to 1, being a
probability density function. Thus, the <code>generator()</code>
function generates probability density functions from another
distribution <span class="math inline">\(G_X(x)\)</span>. In the case of
the code above, the Weibull cumulative distribution function was
assigned to the <code>generator()</code> function, which could be any
other. Note also that I am deriving numerically so that the user does
not need to implement the probability density, which involves a somewhat
larger expression.</p>
<p>You need to understand that all the code above is a programming
strategy, but if you don’t understand it very well, that’s okay, you
just need to implement the probability density function that needs to
generate the observations, in the way you already know how to do.
Ok?</p>
<p><img src="attention.gif"></p>
<p>Now that we have the probability density function with the Modified
Beta Weibull density function - <code>pdf_mbw()</code>, let’s use the
<code><a href="../reference/accept_reject.html">accept_reject()</a></code> function to generate observations of a
sequence of independent and identically distributed (i.i.d.) random
variables with the Modified Beta Weibull distribution.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'AcceptReject'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     qqplot</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># True parameters</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">10.5</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">4.2</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">5.9</span></span>
<span><span class="va">shape</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">scale</span> <span class="op">&lt;-</span> <span class="fl">1.7</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>    f <span class="op">=</span> <span class="va">pdf_mbw</span>,</span>
<span>    args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span>, b <span class="op">=</span> <span class="va">b</span>, beta <span class="op">=</span> <span class="va">beta</span>, shape <span class="op">=</span> <span class="va">shape</span>, scale <span class="op">=</span> <span class="va">scale</span><span class="op">)</span>,</span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2.5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plots</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/qqplot.html">qqplot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, nrow <span class="op">=</span> <span class="fl">1L</span>, labels <span class="op">=</span> <span class="st">"AUTO"</span><span class="op">)</span></span></code></pre></div>
<p><img src="it_works_for_any_univariate_distribution_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Did you notice how easy it is to use the <a href="https://CRAN.R-project.org/package=AcceptReject" class="external-link"><strong>AcceptReject</strong></a>
package? Just implement the probability density function and pass it to
the <code><a href="../reference/accept_reject.html">accept_reject()</a></code> function. It doesn’t matter how you
implemented it; what matters is that you have the function to pass to
the f argument of <code><a href="../reference/accept_reject.html">accept_reject()</a></code>.</p>
<p><img src="wow.gif"></p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pedro Rafael D. Marinho.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
