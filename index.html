<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Provides a function that implements the acceptance-rejection method in an optimized manner to generate pseudo-random observations for discrete or continuous random variables. Proposed by von Neumann J. (1951), &lt;https://mcnp.lanl.gov/pdf_files/&gt;, the function is optimized to work in parallel on Unix-based operating systems and performs well on Windows systems. The acceptance-rejection method implemented optimizes the probability of generating observations from the desired random variable, by simply providing the probability function or probability density function, in the discrete and continuous cases, respectively. Implementation is based on references CASELLA, George at al. (2004) &lt;https://www.jstor.org/stable/4356322&gt;, NEAL, Radford M. (2003) &lt;https://www.jstor.org/stable/3448413&gt; and Bishop, Christopher M. (2006, ISBN: 978-0387310732).">
<title>Acceptance-Rejection Method for Generating Pseudo-Random Observations • AcceptReject</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Acceptance-Rejection Method for Generating Pseudo-Random Observations">
<meta property="og:description" content="Provides a function that implements the acceptance-rejection method in an optimized manner to generate pseudo-random observations for discrete or continuous random variables. Proposed by von Neumann J. (1951), &lt;https://mcnp.lanl.gov/pdf_files/&gt;, the function is optimized to work in parallel on Unix-based operating systems and performs well on Windows systems. The acceptance-rejection method implemented optimizes the probability of generating observations from the desired random variable, by simply providing the probability function or probability density function, in the discrete and continuous cases, respectively. Implementation is based on references CASELLA, George at al. (2004) &lt;https://www.jstor.org/stable/4356322&gt;, NEAL, Radford M. (2003) &lt;https://www.jstor.org/stable/3448413&gt; and Bishop, Christopher M. (2006, ISBN: 978-0387310732).">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">AcceptReject</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/accept_reject.html">Acceptance and rejection method</a>
    <a class="dropdown-item" href="articles/inspect.html">Specifying a base probability density function</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/prdm0/AcceptReject/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="acceptreject-">AcceptReject <a class="anchor" aria-label="anchor" href="#acceptreject-"></a>
</h1>
</div>
<p><a href="https://cran.r-project.org/package=AcceptReject" class="external-link"><img src="https://www.r-pkg.org/badges/version/AcceptReject" alt="CRAN_Status_Badge"></a> <a href="https://github.com/prdm0/AcceptReject/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/prdm0/AcceptReject/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://prdm0.r-universe.dev" class="external-link"><img src="https://prdm0.r-universe.dev/badges/AcceptReject" alt="r-universe"></a> <a href="https://www.gnu.org/licenses/gpl-3.0.en.html" class="external-link"><img src="https://img.shields.io/badge/licence-GPL--3-blue.svg" alt="Licence"></a> <a href="https://cran.r-project.org/package=AcceptReject" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/AcceptReject" alt="Downloads"></a></p>
<p>Generating pseudo-random observations from a probability distribution is a common task in statistics. Being able to generate pseudo-random observations from a probability distribution is useful for simulating scenarios, in <a href="https://en.wikipedia.org/wiki/Monte_Carlo_method" class="external-link">Monte-Carlo</a> methods, which are useful for evaluating various statistical models.</p>
<p>The inversion method is a common way to do this, but it is not always possible to find a closed-form formula for the inverse function of the cumulative distribution function of a random variable <span class="math inline"><em>X</em></span>, that is, <span class="math inline"><em>q</em>(<em>u</em>) = <em>F</em><sup>−1</sup>(<em>u</em>) = <em>x</em></span> (quantile function), where <span class="math inline"><em>F</em></span> is the cumulative distribution function of <span class="math inline"><em>X</em></span> and <span class="math inline"><em>u</em></span> is a uniformly distributed random variable in the interval <span class="math inline">(0,1)</span>.</p>
<p>Whenever possible, it is preferable to use the inversion method to generate pseudo-random observations from a probability distribution. However, when it is not possible to find a closed-form formula for the inverse function of the cumulative distribution function of a random variable, it is necessary to resort to other methods. One way to do this is through the <a href="https://en.wikipedia.org/wiki/Rejection_sampling" class="external-link">acceptance-rejection method</a>, which is a Monte-Carlo procedure. This package aims to provide a function that implements the Acceptance and Rejection method for generating pseudo-random observations from probability distributions that are difficult to sample directly.</p>
<p>The package <a href="https://github.com/prdm0/AcceptReject" class="external-link">AcceptReject</a> provides the <code><a href="reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function that implements the acceptance-rejection method in an optimized manner to generate pseudo-random observations for discrete or continuous random variables. The <code><a href="reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function operates in parallel on Unix-based operating systems such as Linux and MacOS and operates sequentially on Windows-based operating systems; however, it still exhibits good performance. By default, on Unix-based systems, observations are generated sequentially, but it is possible to generate observations in parallel if desired, by using the <code>parallel = TRUE</code> argument.</p>
<p>The <code><a href="reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function, by default, attempts to maximize the probability of acceptance of the pseudo-random observations generated. Suppose <span class="math inline"><em>X</em></span> and <span class="math inline"><em>Y</em></span> are random variables with probability density function (pdf) or probability function (pf) <span class="math inline"><em>f</em></span> and <span class="math inline"><em>g</em></span>, respectively. Furthermore, suppose there exists a constant <span class="math inline"><em>c</em></span> such that</p>
<p><span class="math display">$$\frac{f_X(x)}{g_Y(y)} \leq c.$$</span></p>
<p>By default, the accept_reject function attempts to find the value of <span class="math inline"><em>c</em></span> that maximizes the probability of acceptance of the pseudo-random observations generated. However, it is possible to provide a value of <span class="math inline"><em>c</em></span> to the <code><a href="reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function through the argument <code>c</code>, where <span class="math inline"><em>Y</em></span> is a random variable for which we know how to generate observations. For the <code><a href="reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function, it is not necessary to specify the probability function or probability density function of <span class="math inline"><em>Y</em></span> to generate observations of <span class="math inline"><em>X</em></span> for discrete and continuous cases, respectively. For the discrete and continuous cases, <span class="math inline"><em>Y</em></span> follows the discrete uniform distribution function and continuous uniform distribution function, respectively.</p>
<p>Since the probability of acceptance is <span class="math inline">1/<em>c</em></span>, the <code><a href="reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function attempts to find the minimum value of <span class="math inline"><em>c</em></span> that satisfies the description above. Unless you have compelling reasons to provide a value for the <code>c</code> argument of the <code><a href="reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function, it is recommended to use <code>c = NULL</code> (default), allowing a value of <span class="math inline"><em>c</em></span> to be automatically determined.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The package is being versioned on GitHub. You can install the development version of <a href="https://github.com/prdm0/AcceptReject" class="external-link">AcceptReject</a>, and to do this, you must first install the <a href="https://CRAN.R-project.org/package=remotes" class="external-link">remotes</a> package and then run the following command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="co"># or remotes::install_github("prdm0/AcceptReject", force = TRUE)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span></code></pre></div>
<p>The <code>force = TRUE</code> argument is not necessary. It is only needed in situations where you have already installed the package and want to reinstall it to have a new version.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>Please note the examples below on how to use the <code><a href="reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function to generate pseudo-random observations of discrete and continuous random variables. For further details, refer to the function’s documentation <a href="https://prdm0.github.io/AcceptReject/reference/" class="external-link"><strong>Reference</strong></a> and the <a href="https://prdm0.github.io/AcceptReject/articles/accept_reject.html" class="external-link"><strong>Vignette</strong></a>.</p>
<div class="section level3">
<h3 id="generating-discrete-observations">Generating discrete observations<a class="anchor" aria-label="anchor" href="#generating-discrete-observations"></a>
</h3>
<p>As an example, let <span class="math inline"><em>X</em> ∼ <em>P</em><em>o</em><em>i</em><em>s</em><em>s</em><em>o</em><em>n</em>(<em>λ</em>=0.7)</span>. We will generate <span class="math inline"><em>n</em> = 1000</span> observations of <span class="math inline"><em>X</em></span> using the acceptance-rejection method, using the <code><a href="reference/accept_reject.html">AcceptReject::accept_reject()</a></code> function. Note that it is necessary to provide the <code>xlim</code> argument. Try to set an upper limit value for which the probability of <span class="math inline"><em>X</em></span> assuming that value is zero or very close to zero. In this case, we choose <code>xlim = c(0, 20)</code>, where <code>dpois(x = 20, lambda = 0.7)</code> is very close to zero (1.6286586^{-22}).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span> <span class="co"># install.packages("cowplot")</span></span>
<span><span class="co"># Ensuring Reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">AcceptReject</span><span class="fu">::</span><span class="fu"><a href="reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="va">n</span>,</span>
<span>    f <span class="op">=</span> <span class="va">dpois</span>,</span>
<span>    continuous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>    parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">simulation</span><span class="op">(</span><span class="fl">25L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">simulation</span><span class="op">(</span><span class="fl">250L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">simulation</span><span class="op">(</span><span class="fl">2500L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">simulation</span><span class="op">(</span><span class="fl">25000L</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, <span class="va">d</span>, nrow <span class="op">=</span> <span class="fl">2L</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-2-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="generating-continuous-observations">Generating continuous observations<a class="anchor" aria-label="anchor" href="#generating-continuous-observations"></a>
</h2>
<p>To expand beyond examples of generating pseudo-random observations of discrete random variables, consider now that we want to generate observations from a random variable <span class="math inline"><em>X</em> ∼ 𝒩(<em>μ</em>=0,<em>σ</em><sup>2</sup>=1)</span>. We chose the normal distribution because we are familiar with its form, but you can choose another distribution if desired.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span> <span class="co"># install.packages("cowplot")</span></span>
<span></span>
<span><span class="co"># Ensuring reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">AcceptReject</span><span class="fu">::</span><span class="fu"><a href="reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="va">n</span>,</span>
<span>    f <span class="op">=</span> <span class="va">dnorm</span>,</span>
<span>    continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>    parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Inspecting</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">simulation</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">simulation</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">150L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">simulation</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">250L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">simulation</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2500L</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, <span class="va">d</span>, nrow <span class="op">=</span> <span class="fl">2L</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<p>The <a href="https://prdm0.github.io/AcceptReject/reference/accept_reject.html" class="external-link"><code>accept_reject()</code></a> function supports, <strong>for the continuous case</strong>, specifying a base probability density function if you don’t want to use the continuous uniform distribution as the default base.</p>
<p>When choosing to specify another probability density function different from the uniform one, it’s necessary to specify the following arguments:</p>
<ul>
<li>
<code>f_base</code>: base probability density function;</li>
<li>
<code>random_base</code>: sampling from the base probability density function;</li>
<li>
<code>args_f_base</code>: list with the parameters of the base density.</li>
</ul>
<p>By default, all of them are <code>NULL</code>, and the continuous uniform distribution in <code>xlim</code> is used as the base. If at least one of these arguments is not specified, no error will occur, and the continuous uniform distribution in <code>xlim</code> will still be used as the base.</p>
<p>For the discrete case, if the user mistakenly specifies any of these arguments, i.e., when <code>continuous = FALSE</code>, the <a href="https://prdm0.github.io/AcceptReject/reference/accept_reject.html" class="external-link"><code>accept_reject()</code></a> function will ignore these arguments and use the discrete uniform distribution as the base.</p>
<p>If you choose to specify a base density, it’s convenient to inspect it by comparing the base density function with the theoretical probability density function. The <a href="https://prdm0.github.io/AcceptReject/reference/accept_reject.html" class="external-link"><code>inspect()</code></a> function facilitates this task. The <a href="https://prdm0.github.io/AcceptReject/reference/accept_reject.html" class="external-link"><code>inspect()</code></a> function will plot the base probability density function and the theoretical probability density function, find the intersection between the densities, and display the value of the intersection area on the plot. These are important pieces of information to decide if the base probability density function specified in the <code>args_f_base</code> argument and the value of <code>c</code> (default is 1) are appropriate.</p>
</div>
<div class="section level2">
<h2 id="example-of-inspection">Example of inspection<a class="anchor" aria-label="anchor" href="#example-of-inspection"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span> <span class="co"># install.packages("cowplot")</span></span>
<span></span>
<span><span class="co"># Ensuring reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspecting</span></span>
<span><span class="co"># Case a</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/inspect.html">inspect</a></span><span class="op">(</span></span>
<span>  f <span class="op">=</span> <span class="va">dweibull</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2.1</span>, scale <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span>,</span>
<span>  f_base <span class="op">=</span> <span class="va">dgamma</span>,</span>
<span>  args_f_base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2.8</span>, rate <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  c <span class="op">=</span> <span class="fl">1.2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspecting</span></span>
<span><span class="co"># Case b</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/inspect.html">inspect</a></span><span class="op">(</span></span>
<span>  f <span class="op">=</span> <span class="va">dweibull</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2.1</span>, scale <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span>,</span>
<span>  f_base <span class="op">=</span> <span class="va">dgamma</span>,</span>
<span>  args_f_base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2.9</span>, rate <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  c <span class="op">=</span> <span class="fl">1.4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, nrow <span class="op">=</span> <span class="fl">2L</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<p>Notice that considering the distribution in scenario “a” in the code above is more convenient. Note that the area is approximately 1, the base probability density function with parameters <code>shape = 2.8</code> and <code>rate = 1.2</code> provides a shape close to the theoretical distribution, and <code>c = 1.2</code> ensures that the base density function upper bounds the theoretical probability density function. Therefore, considering <code>f_base</code> with <span class="math inline"><em>Γ</em>(<em>α</em>=2.8,<em>β</em>=1.2)</span> and <code>c = 1.2</code> is a reasonable choice for a base distribution.</p>
<p>Therefore, passing arguments to <code>f_base = dgamma</code>, <code>args_f_base = list(shape = 2.8, rate = 1.2)</code>, and <code>c = 1.2</code> to the <a href="https://prdm0.github.io/AcceptReject/reference/accept_reject.html" class="external-link"><code>accept_reject()</code></a> function will lead us to an even more efficient code.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prdm0.github.io/AcceptReject/" class="external-link">AcceptReject</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jabiru/tictoc" class="external-link">tictoc</a></span><span class="op">)</span> <span class="co"># install.packages("tictoc")</span></span>
<span></span>
<span><span class="co"># Ensuring reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Não especificando a função densidade de probabilidade base</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">tic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">case_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  f <span class="op">=</span> <span class="va">dweibull</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2.1</span>, scale <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">toc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0.009 sec elapsed</span></span>
<span></span>
<span><span class="co"># Specifying the base probability density function</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">tic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">case_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/accept_reject.html">accept_reject</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  continuous <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  f <span class="op">=</span> <span class="va">dweibull</span>,</span>
<span>  args_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2.1</span>, scale <span class="op">=</span> <span class="fl">2.2</span><span class="op">)</span>,</span>
<span>  f_base <span class="op">=</span> <span class="va">dgamma</span>,</span>
<span>  random_base <span class="op">=</span> <span class="va">rgamma</span>,</span>
<span>  args_f_base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2.8</span>, rate <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  c <span class="op">=</span> <span class="fl">1.2</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">toc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; 0.006 sec elapsed</span></span>
<span></span>
<span><span class="co"># Visualizing the results</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">case_1</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">case_2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, nrow <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
<p>Notice that the results were very close in a graphical analysis. However, the execution time specifying a convenient base density was lower for a very large sample.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=AcceptReject" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/prdm0/AcceptReject/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/prdm0/AcceptReject/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing AcceptReject</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Pedro Rafael D. Marinho <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1591-8300" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Vera Lucia Damasceno Tomazella <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-6780-2089" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pedro Rafael D. Marinho, Vera Lucia Damasceno Tomazella.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
